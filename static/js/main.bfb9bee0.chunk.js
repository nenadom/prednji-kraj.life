(this["webpackJsonpjsnes-web"]=this["webpackJsonpjsnes-web"]||[]).push([[0],{36:function(t,e,n){t.exports=n(68)},48:function(t,e,n){},64:function(t,e,n){},65:function(t,e,n){},66:function(t,e,n){},67:function(t,e,n){},68:function(t,e,n){"use strict";n.r(e);var o=n(8),a=n.n(o),s=n(0),r=n.n(s),i=n(10),l=n.n(i),h=n(19);n(48),n(70),n(12);var p={ROMS:{owlia:{name:"The Legends of Owlia",description:r.a.createElement("span",null,r.a.createElement("a",{href:"http://www.gradualgames.com/p/the-legends-of-owlia_1.html",target:"_blank",rel:"noopener noreferrer"},"Owlia by Gradual Games")," ","/"," ",r.a.createElement("a",{href:"http://www.infiniteneslives.com/owlia.php",target:"_blank",rel:"noopener noreferrer"},"Buy the cartridge")),url:"https://cdn.jsdelivr.net/gh/bfirsh/jsnes-roms@master/owlia.nes"},nomolos:{name:"Nomolos: Storming the Catsle",description:r.a.createElement("span",null,r.a.createElement("a",{href:"http://www.gradualgames.com/p/nomolos-storming-catsle.html",target:"_blank",rel:"noopener noreferrer"},"Monolos by Gradual Games")," ","/"," ",r.a.createElement("a",{href:"http://www.infiniteneslives.com/nomolos.php",target:"_blank",rel:"noopener noreferrer"},"Buy the cartridge")),url:"https://cdn.jsdelivr.net/gh/bfirsh/jsnes-roms@master/nomolos.nes"},croom:{name:"Concentration Room",description:r.a.createElement("span",null,r.a.createElement("a",{href:"http://www.pineight.com/croom/README",target:"_blank",rel:"noopener noreferrer"},"Concentration Room")," ","by Damian Yerrick"),url:"https://cdn.jsdelivr.net/gh/bfirsh/jsnes-roms@master/croom/croom.nes"},lj65:{name:"LJ65",description:r.a.createElement("span",null,r.a.createElement("a",{href:"http://harddrop.com/wiki/LJ65",target:"_blank",rel:"noopener noreferrer"},"Concentration Room")," ","by Damian Yerrick"),url:"https://cdn.jsdelivr.net/gh/bfirsh/jsnes-roms@master/lj65/lj65.nes"},tecmo:{name:"Tecmo World Cup Soccer",description:r.a.createElement("span",null,"Tecmo World Cup Soccer"),url:"/roms/tecmo_world_cup_soccer.nes"}},GOOGLE_ANALYTICS_CODE:Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0}).REACT_APP_GOOGLE_ANALYTICS_CODE,SENTRY_URI:Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0}).REACT_APP_SENTRY_URI};s.Component;var d=n(75),u=n(76),m=n(35),c=n(77),g=n(71),f=n(72),C=n(73),y=n(74),b=n(3);class v extends s.Component{constructor(t){super(t),this.state={playerOneButton:"",playerTwoButton:"",waitingForKey:0},this.handleClick=this.handleClick.bind(this)}componentDidMount(){var t=this.props.keys,e=this.props.button,n=[];for(var o in t)1===t[o][0]&&t[o][1]===e?(n[0]=t[o][2],console.log(n[0])):2===t[o][0]&&t[o][1]===e&&(n[1]=t[o][2]);this.setState({playerOneButton:n[0],playerTwoButton:n[1]})}componentDidUpdate(t,e){var n,o,a=this.props.keys,s=this.props.button,r=[];for(var i in a)1===a[i][0]&&a[i][1]===s?(r[0]=a[i][2],console.log(r[0])):2===a[i][0]&&a[i][1]===s&&(r[1]=a[i][2]);var l=(t,e)=>t.buttons.filter(t=>t.buttonId===e)[0],h=(t,e)=>e.buttons.filter(e=>!t||!t.buttons.some(t=>t.buttonId===e.buttonId))[0],p=0,d=0,u=t=>"button"===t.type?"Btn-"+t.code:"axis"===t.type?"Axis-"+t.code+" "+t.value:void 0;if(this.props.gamepadConfig&&this.props.gamepadConfig.playerGamepadId){const e=this.props.gamepadConfig.playerGamepadId;e[0]&&(r[0]="",n=l(this.props.gamepadConfig.configs[e[0]],s),o=h(t.gamepadConfig.configs[e[0]],this.props.gamepadConfig.configs[e[0]]),n?r[0]=u(n):o&&o.buttonId===this.props.prevButton&&(p||(p=1,d=1))),e[1]&&(r[1]="",n=l(this.props.gamepadConfig.configs[e[1]],s),o=h(t.gamepadConfig.configs[e[1]],this.props.gamepadConfig.configs[e[1]]),n?r[1]=u(n):o&&o.buttonId===this.props.prevButton&&(p||(p=2,d=2)))}var m={};p&&this.props.handleClick([d,this.props.button]),e.playerOneButton===r[0]&&e.playerTwoButton===r[1]||(m.playerOneButton=r[0],m.playerTwoButton=r[1]),p?m.waitingForKey=p:1===e.waitingForKey?this.props.currentPromptButton!==this.props.button&&(m.waitingForKey=0):2===e.waitingForKey&&this.props.currentPromptButton!==this.props.button&&(m.waitingForKey=0),Object.keys(m).length>0&&this.setState(m)}handleClick(t){this.props.handleClick([t,this.props.button]),this.setState({waitingForKey:t})}render(){return r.a.createElement("tr",null,r.a.createElement("td",null,this.props.buttonName),r.a.createElement("td",{onClick:()=>this.handleClick(1)},1===this.state.waitingForKey?"Press key or button...":this.state.playerOneButton),r.a.createElement("td",{onClick:()=>this.handleClick(2)},2===this.state.waitingForKey?"Press key or button...":this.state.playerTwoButton))}}var T=v;const w="../img/nes_controller.png";class B extends s.Component{constructor(t){super(t),this.state={gamepadConfig:t.gamepadConfig,keys:t.keys,button:void 0,modified:!1},this.handleKeyDown=this.handleKeyDown.bind(this),this.handleGamepadButtonDown=this.handleGamepadButtonDown.bind(this),this.listenForKey=this.listenForKey.bind(this),this.state.gamepadConfig=this.state.gamepadConfig||{},this.state.gamepadConfig.playerGamepadId=this.state.gamepadConfig.playerGamepadId||[null,null],this.state.gamepadConfig.configs=this.state.gamepadConfig.configs||{},this.state.controllerIcon=this.state.gamepadConfig.playerGamepadId.map(t=>t?w:"../img/keyboard.png"),this.state.controllerIconAlt=this.state.gamepadConfig.playerGamepadId.map(t=>t?"gamepad":"keyboard"),this.state.currentPromptButton=-1}componentWillUnmount(){this.state.modified&&(this.props.setKeys(this.state.keys),this.props.setGamepadConfig(this.state.gamepadConfig)),this.removeKeyListener()}listenForKey(t){var e=t[1];this.removeKeyListener(),this.setState({button:t,currentPromptButton:e}),this.props.promptButton(this.handleGamepadButtonDown),document.addEventListener("keydown",this.handleKeyDown)}handleGamepadButtonDown(t){this.removeKeyListener();var e=this.state.button;const n=e[0],o=e[1],a=t.gamepadId,s=this.state.gamepadConfig,r=s.playerGamepadId.slice(0),i={};r[n-1]=a;const l={code:t.code,type:t.type,buttonId:o,value:t.value};i[a]={buttons:(s.configs[a]||{buttons:[]}).buttons.filter(t=>t.buttonId!==o).concat([l])};const h=Object.assign({},s.configs,i);this.setState({gamepadConfig:{configs:h,playerGamepadId:r},currentPromptButton:-1,controllerIcon:r.map(t=>t?w:"../img/keyboard.png"),modified:!0})}handleKeyDown(t){this.removeKeyListener();var e=this.state.button,n=this.state.keys,o={};for(var a in n)n[a][0]===e[0]&&n[a][1]===e[1]||(o[a]=n[a]);const s=this.state.gamepadConfig.playerGamepadId.slice(0);s[e[0]-1]=null,this.setState({keys:Object(m.a)({},o,{[t.keyCode]:[...e.slice(0,2),t.key.length>1?t.key:String(t.key).toUpperCase()]}),button:void 0,gamepadConfig:{configs:this.state.gamepadConfig.configs,playerGamepadId:s},currentPromptButton:-1,controllerIcon:s.map(t=>t?w:"../img/keyboard.png"),controllerIconAlt:s.map(t=>t?"gamepad":"keyboard"),modified:!0})}removeKeyListener(){this.props.promptButton(null),document.removeEventListener("keydown",this.handleKeyDown)}render(){return r.a.createElement(c.a,{isOpen:this.props.isOpen,toggle:this.props.toggle,className:"ControlsModal"},r.a.createElement(g.a,{toggle:this.props.toggle},"Controls"),r.a.createElement(f.a,null,r.a.createElement(C.a,null,r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"Button"),r.a.createElement("th",null,"Player 1",r.a.createElement("img",{className:"controller-icon",src:this.state.controllerIcon[0],alt:this.state.controllerIconAlt[0]})),r.a.createElement("th",null,"Player 2",r.a.createElement("img",{className:"controller-icon",src:this.state.controllerIcon[1],alt:this.state.controllerIconAlt[1]})))),r.a.createElement("tbody",null,r.a.createElement(T,{buttonName:"Left",currentPromptButton:this.state.currentPromptButton,button:b.Controller.BUTTON_LEFT,prevButton:b.Controller.BUTTON_SELECT,keys:this.state.keys,handleClick:this.listenForKey,gamepadConfig:this.state.gamepadConfig}),r.a.createElement(T,{buttonName:"Right",currentPromptButton:this.state.currentPromptButton,button:b.Controller.BUTTON_RIGHT,prevButton:b.Controller.BUTTON_LEFT,keys:this.state.keys,handleClick:this.listenForKey,gamepadConfig:this.state.gamepadConfig}),r.a.createElement(T,{buttonName:"Up",currentPromptButton:this.state.currentPromptButton,button:b.Controller.BUTTON_UP,prevButton:b.Controller.BUTTON_RIGHT,keys:this.state.keys,handleClick:this.listenForKey,gamepadConfig:this.state.gamepadConfig}),r.a.createElement(T,{buttonName:"Down",currentPromptButton:this.state.currentPromptButton,button:b.Controller.BUTTON_DOWN,prevButton:b.Controller.BUTTON_UP,keys:this.state.keys,handleClick:this.listenForKey,gamepadConfig:this.state.gamepadConfig}),r.a.createElement(T,{buttonName:"A",currentPromptButton:this.state.currentPromptButton,button:b.Controller.BUTTON_A,prevButton:b.Controller.BUTTON_DOWN,keys:this.state.keys,handleClick:this.listenForKey,gamepadConfig:this.state.gamepadConfig}),r.a.createElement(T,{buttonName:"B",currentPromptButton:this.state.currentPromptButton,button:b.Controller.BUTTON_B,prevButton:b.Controller.BUTTON_A,keys:this.state.keys,handleClick:this.listenForKey,gamepadConfig:this.state.gamepadConfig}),r.a.createElement(T,{buttonName:"Start",currentPromptButton:this.state.currentPromptButton,button:b.Controller.BUTTON_START,prevButton:b.Controller.BUTTON_B,keys:this.state.keys,handleClick:this.listenForKey,gamepadConfig:this.state.gamepadConfig}),r.a.createElement(T,{buttonName:"Select",currentPromptButton:this.state.currentPromptButton,button:b.Controller.BUTTON_SELECT,prevButton:b.Controller.BUTTON_START,keys:this.state.keys,handleClick:this.listenForKey,gamepadConfig:this.state.gamepadConfig})))),r.a.createElement(y.a,null,r.a.createElement(d.a,{outline:!0,color:"primary",onClick:this.props.toggle},"Close")))}}var E=B;class k{constructor(t){this.onAnimationFrame=t=>{this.requestAnimationFrame();let e=t%this.interval,n=t-e;if(!this.lastFrameTime)return void(this.lastFrameTime=n);let o=Math.round((n-this.lastFrameTime)/this.interval);if(0===o)return;this.generateFrame(),this.onWriteFrame();let a=this.interval-e;for(let s=1;s<o;s++)setTimeout(()=>{this.generateFrame()},s*a/o);o>1&&console.log("SKIP",o-1,this.lastFrameTime)},this.onGenerateFrame=t.onGenerateFrame,this.onWriteFrame=t.onWriteFrame,this.onAnimationFrame=this.onAnimationFrame.bind(this),this.running=!0,this.interval=1e3/60.098,this.lastFrameTime=!1}start(){this.running=!0,this.requestAnimationFrame()}stop(){this.running=!1,this._requestID&&window.cancelAnimationFrame(this._requestID),this.lastFrameTime=!1}requestAnimationFrame(){this._requestID=window.requestAnimationFrame(this.onAnimationFrame)}generateFrame(){this.onGenerateFrame(),this.lastFrameTime+=this.interval}}class N{constructor(t){this.disableIfGamepadEnabled=t=>{var e=this;return(n,o)=>{if(!e.gamepadConfig)return t(n,o);var a=e.gamepadConfig.playerGamepadId;return a&&a[n-1]?void 0:t(n,o)}},this._getPlayerNumberFromGamepad=t=>this.gamepadConfig.playerGamepadId[0]===t.id?1:this.gamepadConfig.playerGamepadId[1]===t.id?2:1,this.poll=()=>{const t=navigator.getGamepads?navigator.getGamepads():navigator.webkitGetGamepads(),e=[];for(let n=0;n<t.length;n++){const o=t[n],a=this.gamepadState[n];if(!o)continue;if(!a){this.gamepadState[n]=o;continue}const s=o.buttons,r=a.buttons;if(this.buttonCallback){for(let t=0;t<o.axes.length;t++){const e=o.axes[t],n=a.axes[t];-1===e&&-1!==n&&this.buttonCallback({gamepadId:o.id,type:"axis",code:t,value:e}),1===e&&1!==n&&this.buttonCallback({gamepadId:o.id,type:"axis",code:t,value:e})}for(let t=0;t<s.length;t++){const e=s[t],n=r[t];e.pressed&&!n.pressed&&this.buttonCallback({gamepadId:o.id,type:"button",code:t})}}else if(this.gamepadConfig){let t=this._getPlayerNumberFromGamepad(o);if(e.length<2&&(-1!==e.indexOf(t)&&(t++,t>2&&(t=1)),e.push(t),this.gamepadConfig.configs[o.id])){const e=this.gamepadConfig.configs[o.id].buttons;for(let n=0;n<e.length;n++){const i=e[n];if("button"===i.type){const e=i.code,n=s[e],o=r[e];n.pressed&&!o.pressed?this.onButtonDown(t,i.buttonId):!n.pressed&&o.pressed&&this.onButtonUp(t,i.buttonId)}else if("axis"===i.type){const e=i.code,n=o.axes[e],s=a.axes[e];n===i.value&&s!==i.value&&this.onButtonDown(t,i.buttonId),n!==i.value&&s===i.value&&this.onButtonUp(t,i.buttonId)}}}}this.gamepadState[n]={buttons:s.map(t=>({pressed:t.pressed})),axes:o.axes.slice(0)}}},this.promptButton=t=>{this.buttonCallback=t?e=>{this.buttonCallback=null,t(e)}:t},this.loadGamepadConfig=()=>{var t;try{(t=localStorage.getItem("gamepadConfig"))&&(t=JSON.parse(t))}catch(e){console.log("Failed to get gamepadConfig from localStorage.",e)}this.gamepadConfig=t},this.setGamepadConfig=t=>{try{localStorage.setItem("gamepadConfig",JSON.stringify(t)),this.gamepadConfig=t}catch(e){console.log("Failed to set gamepadConfig in localStorage")}},this.startPolling=()=>{if(!navigator.getGamepads&&!navigator.webkitGetGamepads)return{stop:()=>{}};let t=!1;const e=()=>{t||(this.poll(),requestAnimationFrame(e))};return requestAnimationFrame(e),{stop:()=>{t=!0}}},this.onButtonDown=t.onButtonDown,this.onButtonUp=t.onButtonUp,this.gamepadState=[],this.buttonCallback=null}}const O={88:[1,b.Controller.BUTTON_A,"X"],89:[1,b.Controller.BUTTON_B,"Y"],90:[1,b.Controller.BUTTON_B,"Z"],17:[1,b.Controller.BUTTON_SELECT,"Right Ctrl"],13:[1,b.Controller.BUTTON_START,"Enter"],38:[1,b.Controller.BUTTON_UP,"Up"],40:[1,b.Controller.BUTTON_DOWN,"Down"],37:[1,b.Controller.BUTTON_LEFT,"Left"],39:[1,b.Controller.BUTTON_RIGHT,"Right"],103:[2,b.Controller.BUTTON_A,"Num-7"],105:[2,b.Controller.BUTTON_B,"Num-9"],99:[2,b.Controller.BUTTON_SELECT,"Num-3"],97:[2,b.Controller.BUTTON_START,"Num-1"],104:[2,b.Controller.BUTTON_UP,"Num-8"],98:[2,b.Controller.BUTTON_DOWN,"Num-2"],100:[2,b.Controller.BUTTON_LEFT,"Num-4"],102:[2,b.Controller.BUTTON_RIGHT,"Num-6"]};class S{constructor(t){this.loadKeys=()=>{var t;try{(t=localStorage.getItem("keys"))&&(t=JSON.parse(t))}catch(e){console.log("Failed to get keys from localStorage.",e)}this.keys=t||O},this.setKeys=t=>{try{localStorage.setItem("keys",JSON.stringify(t)),this.keys=t}catch(e){console.log("Failed to set keys in localStorage")}},this.handleKeyDown=t=>{var e=this.keys[t.keyCode];e&&(this.onButtonDown(e[0],e[1]),t.preventDefault())},this.handleKeyUp=t=>{var e=this.keys[t.keyCode];e&&(this.onButtonUp(e[0],e[1]),t.preventDefault())},this.handleKeyPress=t=>{t.preventDefault()},this.onButtonDown=t.onButtonDown,this.onButtonUp=t.onButtonUp}}n(64);class U extends s.Component{constructor(...t){super(...t),this.setBuffer=t=>{for(var e=0,n=0;n<240;++n)for(var o=0;o<256;++o)e=256*n+o,this.buf32[e]=4278190080|t[e]},this.writeBuffer=()=>{this.imageData.data.set(this.buf8),this.context.putImageData(this.imageData,0,0)},this.fitInParent=()=>{let t=this.canvas.parentNode,e=t.clientWidth,n=t.clientHeight;256/240<e/n?(this.canvas.style.width="".concat(Math.round(n*(256/240)),"px"),this.canvas.style.height="".concat(n,"px")):(this.canvas.style.width="".concat(e,"px"),this.canvas.style.height="".concat(Math.round(e/(256/240)),"px"))},this.handleMouseDown=t=>{if(!this.props.onMouseDown)return;let e=256/parseFloat(this.canvas.style.width),n=this.canvas.getBoundingClientRect(),o=Math.round((t.clientX-n.left)*e),a=Math.round((t.clientY-n.top)*e);this.props.onMouseDown(o,a)}}render(){return r.a.createElement("canvas",{className:"Screen",width:256,height:240,onMouseDown:this.handleMouseDown,onMouseUp:this.props.onMouseUp,ref:t=>{this.canvas=t}})}componentDidMount(){this.initCanvas()}componentDidUpdate(){this.initCanvas()}initCanvas(){this.context=this.canvas.getContext("2d"),this.imageData=this.context.getImageData(0,0,256,240),this.context.fillStyle="black",this.context.fillRect(0,0,256,240),this.buf=new ArrayBuffer(this.imageData.data.length),this.buf8=new Uint8ClampedArray(this.buf),this.buf32=new Uint32Array(this.buf);for(var t=0;t<this.buf32.length;++t)this.buf32[t]=4278190080}screenshot(){var t=new Image;return t.src=this.canvas.toDataURL("image/png"),t}}var _=U,D=n(34),I=n.n(D);const F=(t,e)=>{console.error(t),a.a.captureException(t,{extra:e})};class P{constructor({onBufferUnderrun:t}){this.writeSample=(t,e)=>{this.buffer.size()/2>=this.bufferSize&&(console.log("Buffer overrun"),this.buffer.deqN(this.bufferSize/2)),this.buffer.enq(t),this.buffer.enq(e)},this.onaudioprocess=t=>{var e=t.outputBuffer.getChannelData(0),n=t.outputBuffer.getChannelData(1),o=e.length;this.buffer.size()<2*o&&this.onBufferUnderrun&&this.onBufferUnderrun(this.buffer.size(),2*o);try{var a=this.buffer.deqN(2*o)}catch(t){var s=this.buffer.size()/2;s>0&&console.log("Buffer underrun (needed ".concat(o,", got ").concat(s,")"));for(var r=0;r<o;r++)e[r]=0,n[r]=0;return}for(var i=0;i<o;i++)e[i]=a[2*i],n[i]=a[2*i+1]},this.onBufferUnderrun=t,this.bufferSize=8192,this.buffer=new I.a(2*this.bufferSize)}getSampleRate(){if(!window.AudioContext)return 44100;let t=new window.AudioContext,e=t.sampleRate;return t.close(),e}start(){window.AudioContext&&(this.audioCtx=new window.AudioContext,this.scriptNode=this.audioCtx.createScriptProcessor(1024,0,2),this.scriptNode.onaudioprocess=this.onaudioprocess,this.scriptNode.connect(this.audioCtx.destination))}stop(){this.scriptNode&&(this.scriptNode.disconnect(this.audioCtx.destination),this.scriptNode.onaudioprocess=null,this.scriptNode=null),this.audioCtx&&(this.audioCtx.close().catch(F),this.audioCtx=null)}}class G extends s.Component{constructor(...t){super(...t),this.start=()=>{this.frameTimer.start(),this.speakers.start(),this.fpsInterval=setInterval(()=>{console.log("FPS: ".concat(this.nes.getFPS()))},1e3)},this.stop=()=>{this.frameTimer.stop(),this.speakers.stop(),clearInterval(this.fpsInterval)}}render(){return r.a.createElement(_,{ref:t=>{this.screen=t},onGenerateFrame:()=>{this.nes.frame()},onMouseDown:(t,e)=>{this.nes.zapperMove(t,e),this.nes.zapperFireDown()},onMouseUp:()=>{this.nes.zapperFireUp()}})}componentDidMount(){this.fitInParent(),this.speakers=new P({onBufferUnderrun:(t,e)=>{this.props.paused||(console.log("Buffer underrun, running another frame to try and catch up"),this.frameTimer.generateFrame(),this.speakers.buffer.size()<e&&(console.log("Still buffer underrun, running a second frame"),this.frameTimer.generateFrame()))}}),this.nes=new b.NES({onFrame:this.screen.setBuffer,onStatusUpdate:console.log,onAudioSample:this.speakers.writeSample,sampleRate:this.speakers.getSampleRate()}),window.nes=this.nes,this.frameTimer=new k({onGenerateFrame:a.a.wrap(this.nes.frame),onWriteFrame:a.a.wrap(this.screen.writeBuffer)}),this.gamepadController=new N({onButtonDown:this.nes.buttonDown,onButtonUp:this.nes.buttonUp}),this.gamepadController.loadGamepadConfig(),this.gamepadPolling=this.gamepadController.startPolling(),this.keyboardController=new S({onButtonDown:this.gamepadController.disableIfGamepadEnabled(this.nes.buttonDown),onButtonUp:this.gamepadController.disableIfGamepadEnabled(this.nes.buttonUp)}),this.keyboardController.loadKeys(),document.addEventListener("keydown",this.keyboardController.handleKeyDown),document.addEventListener("keyup",this.keyboardController.handleKeyUp),document.addEventListener("keypress",this.keyboardController.handleKeyPress),this.nes.loadROM(this.props.romData),this.start()}componentWillUnmount(){this.stop(),document.removeEventListener("keydown",this.keyboardController.handleKeyDown),document.removeEventListener("keyup",this.keyboardController.handleKeyUp),document.removeEventListener("keypress",this.keyboardController.handleKeyPress),this.gamepadPolling.stop(),window.nes=void 0}componentDidUpdate(t){this.props.paused!==t.paused&&(this.props.paused?this.stop():this.start())}fitInParent(){this.screen.fitInParent()}}var x=G;n(65);class K extends s.Component{constructor(t){super(t),this.load=()=>{this.currentRequest=function(t,e,n){var o=new XMLHttpRequest;return o.open("GET",t),o.overrideMimeType("text/plain; charset=x-user-defined"),o.onload=function(){if(200===this.status){if(o.responseText.match(/^<!doctype html>/i))return e(new Error("Page not found"));e(null,this.responseText)}else 0===this.status||e(new Error(o.statusText))},o.onerror=function(){e(new Error(o.statusText))},o.onprogress=n,o.send(),o}(p.ROMS.tecmo.url,(t,e)=>{t?this.setState({error:"Error loading ROM: ".concat(t.message)}):this.handleLoaded(e)},this.handleProgress)},this.handleProgress=t=>{t.lengthComputable&&this.setState({loadedPercent:t.loaded/t.total*100})},this.handleLoaded=t=>{this.setState({running:!0,loading:!1,romData:t})},this.handlePauseResume=()=>{this.setState({paused:!this.state.paused})},this.layout=()=>{let t=parseFloat(window.getComputedStyle(this.navbar).height);this.screenContainer.style.height="".concat(window.innerHeight-t,"px"),this.emulator&&this.emulator.fitInParent()},this.toggleControlsModal=()=>{this.setState({controlsModalOpen:!this.state.controlsModalOpen})},this.state={romName:null,romData:null,running:!1,paused:!1,controlsModalOpen:!1,loading:!0,loadedPercent:3,error:null,started:!1}}render(){return r.a.createElement("div",{className:"RunPage"},r.a.createElement("nav",{className:"navbar navbar-expand",ref:t=>{this.navbar=t}},r.a.createElement("ul",{className:"navbar-nav ml-auto mr-auto"},r.a.createElement("li",{className:"navitem"},r.a.createElement("span",{className:"navbar-text mr-3"},this.state.romName))),r.a.createElement("ul",{className:"navbar-nav",style:{width:"200px"}},r.a.createElement("li",{className:"navitem"},r.a.createElement(d.a,{outline:!0,color:"primary",onClick:this.toggleControlsModal,className:"mr-3"},"Controls"),r.a.createElement(d.a,{outline:!0,color:"primary",onClick:this.handlePauseResume,disabled:!this.state.running},this.state.paused?"Resume":"Pause")))),this.state.error?this.state.error:r.a.createElement("div",{className:"screen-container",ref:t=>{this.screenContainer=t}},this.state.loading?r.a.createElement(u.a,{value:this.state.loadedPercent,style:{position:"absolute",width:"70%",left:"15%",top:"48%"}}):this.state.romData?this.state.started?r.a.createElement(x,{romData:this.state.romData,paused:this.state.paused,ref:t=>{this.emulator=t}}):r.a.createElement(d.a,{outline:!0,size:"lg",style:{marginTop:200},color:"primary",onClick:()=>{this.setState({started:!0})}},"Click here"):null,this.state.controlsModalOpen&&r.a.createElement(E,{isOpen:this.state.controlsModalOpen,toggle:this.toggleControlsModal,keys:this.emulator.keyboardController.keys,setKeys:this.emulator.keyboardController.setKeys,promptButton:this.emulator.gamepadController.promptButton,gamepadConfig:this.emulator.gamepadController.gamepadConfig,setGamepadConfig:this.emulator.gamepadController.setGamepadConfig})))}componentDidMount(){window.addEventListener("resize",this.layout),this.layout(),this.load()}componentWillUnmount(){window.removeEventListener("resize",this.layout),this.currentRequest&&this.currentRequest.abort()}}var A=K;n(66);class R extends s.Component{constructor(t){super(t),this.recordPageview=({location:t})=>(h.a.pageview(t.pathname),null),this.state={error:null},p.GOOGLE_ANALYTICS_CODE&&h.a.initialize(p.GOOGLE_ANALYTICS_CODE)}render(){return r.a.createElement(A,null)}componentDidCatch(t,e){this.setState({error:t}),F(t,e)}}var L=R;n(67);p.SENTRY_URI&&a.a.config(p.SENTRY_URI).install(),a.a.context((function(){l.a.render(r.a.createElement(L,null),document.getElementById("root"))}))}},[[36,1,2]]]);
//# sourceMappingURL=main.bfb9bee0.chunk.js.map